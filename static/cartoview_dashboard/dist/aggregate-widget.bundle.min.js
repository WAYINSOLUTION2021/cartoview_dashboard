webpackJsonp([7],{14:function(e,t,n){"use strict";t.__esModule=!0;var r=n(19);t.default=new r.EventEmitter},19:function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,a,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(n=this._events[e],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(o(n))for(a=Array.prototype.slice.call(arguments,1),l=n.slice(),i=l.length,u=0;u<i;u++)l[u].apply(this,a);return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,s,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},584:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){var e="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;return function(t,n,r,i){var o=t&&t.defaultProps,s=arguments.length-3;if(n||0===s||(n={}),n&&o)for(var a in o)void 0===n[a]&&(n[a]=o[a]);else n||(n=o||{});if(1===s)n.children=i;else if(s>1){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+3];n.children=u}return{$$typeof:e,type:t,key:void 0===r?null:""+r,ref:null,props:n,_owner:null}}}(),u=n(2),l=(r(u),n(9)),f=r(l),c=n(14),p=r(c),h=function(e){function t(n){i(this,t);var r=o(this,e.call(this,n));return r.wpsClient=new WpsClient({geoserverUrl:"/geoserver"}),r.state.aggregateResult="NaN",r.configFieldSetClass=v,r}return s(t,e),t.prototype.componentDidMount=function(){var e=this;p.default.on("mapExtentChanged",function(t,n){e.update(e.state.config,n)}),this.update(this.state.config)},t.prototype.update=function(e,t){var n=this;e.typeName&&(e=Object.assign({},e),t&&(e.filters={minx:t[0],miny:t[1],maxx:t[2],maxy:t[3]}),this.wpsClient.aggregate(e).then(function(e){n.setData(e)}))},t.prototype.setData=function(e){this.setState({aggregateResult:e.AggregationResults[0][0]})},t.prototype.render=function(){return a("div",{className:"aggregate-widget"},void 0,a("h1",{className:"text-center"},void 0,this.state.aggregateResult))},t}(BaseWidget),v=function(e){function t(n){i(this,t);var r=o(this,e.call(this,n));return r.state.layers=[],r.state.attributes=[],r}return s(t,e),t.prototype.getInitialData=function(e){return e.widget.getConfig()},t.prototype.getSchema=function(){return{typeName:{type:"select",label:"Layer",options:{},props:{onChange:function(e){e.target.fieldSet.updateAttributes()}}},aggregationAttribute:{type:"select",label:"Aggregation Attribute",options:{}},aggregationFunction:{type:"select",label:"Aggregation Function",defaultValue:"Sum",options:{Sum:"Sum",Count:"Count",Average:"Average",Max:"Max",Min:"Min",Median:"Median"}}}},t.prototype.getSelectOptions=function(t,n,r){if("typeName"==t)return this.state.layers.map(function(e){return a("option",{value:e.typename},void 0,e.title)});if("aggregationAttribute"==t){var i=function(e){return-1!=["xsd:int","xsd:long","xsd:double"].indexOf(e.attribute_type)};return this.state.attributes.filter(function(e){return i(e)}).map(function(e){return a("option",{value:e.attribute},void 0,e.attribute_label||e.attribute)})}return e.prototype.getSelectOptions.call(this,t,n,r)},t.prototype.updateAttributes=function(e){var t=this;this.setState({data:e||this.getData()}),getAttributesData(this.fields.typeName.value).then(function(e){return t.setState({attributes:e.objects})})},t.prototype.componentDidMount=function(){var e=this;getLayersData().then(function(t){e.setLayers(t),e.state.data.typeName&&e.updateAttributes(e.state.data)})},t.prototype.setLayers=function(e){this.setState({layers:e.objects})},t}(f.default);h.ConfigForm=v,Dashboard.registerWidget(h),t.default=h},9:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){var e="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;return function(t,n,r,i){var o=t&&t.defaultProps,s=arguments.length-3;if(n||0===s||(n={}),n&&o)for(var a in o)void 0===n[a]&&(n[a]=o[a]);else n||(n=o||{});if(1===s)n.children=i;else if(s>1){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+3];n.children=u}return{$$typeof:e,type:t,key:void 0===r?null:""+r,ref:null,props:n,_owner:null}}}(),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=n(2),p=r(c),h=function(e){function t(n){o(this,t);var r=s(this,e.call(this,n));return Object.defineProperty(r,"value",{get:function(){return JSON.parse(r.refs.textarea.value)},set:function(e){r.refs.textarea.value=JSON.stringify(e||{})},enumerable:!0,configurable:!0}),r}return a(t,e),t.prototype.render=function(){var e=i(this.props,[]);return delete e.ref,p.default.createElement("textarea",f({},e,{ref:"textarea"}))},t}(c.Component),v=function(e){function t(n){o(this,t);var r=s(this,e.call(this,n));return r.state={schema:n.schema||r.getSchema(n),data:n.data||r.getInitialData(n)},r.fields={},r}return a(t,e),t.prototype.getSchema=function(){return{}},t.prototype.getInitialData=function(){return{}},t.prototype.render=function(){var e=this,t=this.state,n=t.schema,r=t.data;return l("div",{},void 0,Object.keys(n).map(function(t){return e.field(t,n[t],n[t].getValue?n[t].getValue(r):r[t]||null)}))},t.prototype.field=function(e,t,n){var r=this,i=t.props,o=void 0===i?{}:i;o.className="form-control",o.ref=function(t){t&&(t.value=n,r.fields[e]=t,t.fieldSet=r)};var s=null;-1!=["text","number","url","email"].indexOf(t.type)?(o.type=t.type,s=p.default.createElement("input",o)):"textarea"==t.type?s=p.default.createElement("textarea",o):"json"==t.type?s=p.default.createElement(h,o):"select"==t.type&&(s=p.default.createElement("select",o,this.getSelectOptions(e,t,n)));var a=t.label||e.charAt(0).toUpperCase()+e.slice(1);return l("div",{className:"form-group"},void 0,l("label",{},void 0,a),s)},t.prototype.getSelectOptions=function(e,t,n){var r=t.options;return r?"object"==(void 0===r?"undefined":u(r))?Object.keys(r).map(function(e){return l("option",{value:e},void 0,r[e])}):"function"==typeof r?r(this,this.state.data):null:null},t.prototype.getData=function(){var e=this,t={};return Object.keys(this.fields).map(function(n){t[n]=e.fields[n].value}),t},t}(c.Component);t.default=v}},[584]);