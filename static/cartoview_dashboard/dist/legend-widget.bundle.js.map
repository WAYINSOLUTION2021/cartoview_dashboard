{"version":3,"sources":["webpack:///./src/components/FieldSet.jsx?d030***","webpack:///./src/events/Events.jsx?1090**","webpack:///./~/events/events.js?7c71**","webpack:///./~/boundless-sdk/util.js?3120*","webpack:///./~/boundless-sdk/services/ArcGISRestService.js","webpack:///./~/querystringify/index.js?fabd*","webpack:///./~/requires-port/index.js?2f61*","webpack:///./~/url-parse/index.js?8de2*","webpack:///./src/legend-widget.jsx"],"names":["JSONField","props","Object","defineProperty","get","JSON","parse","refs","textarea","value","set","newValue","stringify","enumerable","configurable","render","ref","FieldSet","state","schema","getSchema","data","getInitialData","fields","keys","map","field","key","getValue","name","className","f","fieldSet","indexOf","type","getSelectOptions","label","charAt","toUpperCase","slice","options","getData","ArcGISLegend","legendInfo","layers","style","width","height","l","legend","contentType","imageData","componentDidMount","layer","source","getSource","url","getUrls","getLegend","setState","Legend","legends","getLegends","getLayers","getArray","forEach","Group","concat","getVisible","hasLegend","isWMS","s","p","getParams","LAYERS","STYLES","push","TileArcGISRest","Tile","TileWMS","Image","ImageWMS","LegendWidget","padding","ready","color","setConfig","config","attachToMapWidget","mapWidget","mapWidgetId","context","configManager","getWidget","on","BaseWidget","displayName","ConfigForm","maps","lable","widget","getConfig","mapWidgets","getMapWidgets","filter","dash","widgets","widgetId","title","Dashboard","registerWidget"],"mappings":"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P,CAAYgB,OAAZ,EAAqBf,GAArB,CAAyB;AAAA;AAAA,iBAAsBE;AAAtB,mBAA4Ba,QAAQb,GAAR,CAA5B;AAAA,OAAzB,CAAP;AACD,KAFD,MAGK,IAAG,OAAOa,OAAP,IAAkB,UAArB,EAAiC;AACpC,aAAOA,QAAQ,IAAR,EAAc,KAAKtB,KAAL,CAAWG,IAAzB,CAAP;AACD;AACD,WAAO,IAAP;AACD,G;;qBACDoB,O,sBAAS;AAAA;;AACP,QAAIpB,OAAO,EAAX;AACAnB,WAAOsB,IAAP,CAAY,KAAKD,MAAjB,EAAyBE,GAAzB,CAA6B,UAACE,GAAD,EAAS;AAAEN,WAAKM,GAAL,IAAY,OAAKJ,MAAL,CAAYI,GAAZ,EAAiBlB,KAA7B;AAAqC,KAA7E;AACA,WAAOY,IAAP;AACD,G;;;;;kBAGYJ,Q;;;;;;;;;;;;AC3Ff;;kBACe,0B;;;;;;;ACDf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH,oBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;AC7SA;;AAEA;AACA;AACA,CAAC;;AAED;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,kDAAkD,QAAQ;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA,8BAA8B,EAAE,UAAU,EAAE,UAAU,EAAE;AACxD;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,M;;;;;;;;ACjIA;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,kDAAkD,QAAQ;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA,sBAAsB;AACtB,mDAAmD,QAAQ;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,8BAA8B,kEAAkE;AAChG,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED,0C;;;;;;;;ACxNA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;ACvEA;;AAEA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;8CCrCA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,cAAc;;AAEd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,yDAAyD;AACzD,GAAG;AACH,sCAAsC;AACtC;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,QAAQ;AACtB,cAAc,OAAO;AACrB;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,gBAAgB;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,cAAc;AACzB,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,yBAAyB;AACjC;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;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","file":"legend-widget.bundle.js","sourcesContent":["import React, {Component} from 'react';\r\n\r\nclass JSONField extends Component{\r\n  constructor(props){\r\n    super(props);\r\n    Object.defineProperty(this, 'value', {\r\n      get: () => { return JSON.parse(this.refs.textarea.value); },\r\n      set: (newValue) => { this.refs.textarea.value = JSON.stringify(newValue || {}); },\r\n      enumerable: true,\r\n      configurable: true\r\n    });\r\n  }\r\n  render(){\r\n    const {...props} = this.props;\r\n    delete props.ref;\r\n    return <textarea {...props} ref=\"textarea\" />;\r\n  }\r\n}\r\nclass FieldSet extends Component{\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      schema: props.schema || this.getSchema(props),\r\n      data: props.data || this.getInitialData(props)\r\n    };\r\n    this.fields = {};\r\n  }\r\n  getSchema(){\r\n    return {};\r\n  }\r\n  getInitialData(){\r\n    return {};\r\n  }\r\n  render(){\r\n    const {schema, data} = this.state;\r\n    return <div>\r\n      {Object.keys(schema).map(key => this.field(key, schema[key], schema[key].getValue ? schema[key].getValue(data) : data[key] || null))}\r\n    </div>\r\n  }\r\n\r\n  field(name, schema, value){\r\n    var {props={}} = schema;\r\n    props.className = \"form-control\";\r\n    props.ref = (f) => {\r\n      if(f){\r\n        f.value = value;\r\n        this.fields[name] = f;\r\n        f.fieldSet = this;\r\n      }\r\n    };\r\n    var field = null;\r\n\r\n    if(['text', 'number', 'url', 'email'].indexOf(schema.type) != -1){\r\n      props.type = schema.type;\r\n      field = <input {...props} />;\r\n    }\r\n    else if(schema.type == \"textarea\"){\r\n      field = <textarea {...props} />;\r\n    }\r\n    else if(schema.type == \"json\"){\r\n      field = <JSONField {...props}/>\r\n    }\r\n    else if(schema.type == 'select'){\r\n      field =  <select {...props}>\r\n        {this.getSelectOptions(name, schema, value)}\r\n      </select>;\r\n    }\r\n    var label = schema.label || (name.charAt(0).toUpperCase() + name.slice(1));\r\n    return <div className=\"form-group\">\r\n      <label>{label}</label>\r\n      {field}\r\n    </div>;\r\n  }\r\n  getSelectOptions(name, schema, value){\r\n    var {options} = schema;\r\n    if(!options) return null;\r\n    if(typeof options == \"object\"){\r\n      return Object.keys(options).map(key => <option value={key}>{options[key]}</option>)\r\n    }\r\n    else if(typeof options == 'function' ){\r\n      return options(this, this.state.data);\r\n    }\r\n    return null\r\n  }\r\n  getData(){\r\n    var data = {};\r\n    Object.keys(this.fields).map((key) => { data[key] = this.fields[key].value; });\r\n    return data;\r\n  }\r\n}\r\n\r\nexport default FieldSet;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/FieldSet.jsx","import {EventEmitter}  from 'events';\r\nexport default new EventEmitter();\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/events/Events.jsx","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/events/events.js\n// module id = 20\n// module chunks = 0 4 5 6 7","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _openlayers = require('openlayers');\n\nvar _openlayers2 = _interopRequireDefault(_openlayers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = {\n  getProxiedUrl: function getProxiedUrl(url, opt_proxy) {\n    if (opt_proxy) {\n      return opt_proxy + encodeURIComponent(url);\n    } else {\n      return url;\n    }\n  },\n  getResolutionForScale: function getResolutionForScale(scale, units) {\n    var dpi = 25.4 / 0.28;\n    var mpu = _openlayers2.default.proj.METERS_PER_UNIT[units];\n    var inchesPerMeter = 39.37;\n    return parseFloat(scale) / (mpu * inchesPerMeter * dpi);\n  },\n  getTimeInfo: function getTimeInfo(layer) {\n    if (layer.Dimension) {\n      for (var i = 0, ii = layer.Dimension.length; i < ii; ++i) {\n        var dimension = layer.Dimension[i];\n        if (dimension.name === 'time') {\n          return dimension.values;\n        }\n      }\n    }\n  },\n  rgbToHex: function rgbToHex(rgb) {\n    rgb = rgb.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n    return rgb && rgb.length === 4 ? '#' + ('0' + parseInt(rgb[1], 10).toString(16)).slice(-2) + ('0' + parseInt(rgb[2], 10).toString(16)).slice(-2) + ('0' + parseInt(rgb[3], 10).toString(16)).slice(-2) : '';\n  },\n  hexToRgb: function hexToRgb(hex) {\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16)\n    } : null;\n  },\n  transformColor: function transformColor(color) {\n    var colorObj = color.rgb ? color.rgb : color;\n    return [colorObj.r, colorObj.g, colorObj.b, colorObj.a];\n  },\n  doJSONP: function doJSONP(url, success, failure, scope) {\n    function getRandomInt(min, max) {\n      min = Math.ceil(min);\n      max = Math.floor(max);\n      return Math.floor(Math.random() * (max - min)) + min;\n    }\n    var cbname = 'fn' + Date.now() + getRandomInt(1, 10000);\n    var script = document.createElement('script');\n    script.onerror = function () {\n      if (failure) {\n        failure.call(scope);\n      }\n    };\n    script.src = url.replace('__cbname__', cbname);\n    window[cbname] = function (jsonData) {\n      success.call(scope, jsonData);\n      delete window[cbname];\n    };\n    document.head.appendChild(script);\n  },\n  doGET: function doGET(url, success, failure, scope, opt_requestHeaders) {\n    var xmlhttp = new XMLHttpRequest();\n    xmlhttp.onreadystatechange = function () {\n      if (xmlhttp.readyState === 4) {\n        if (xmlhttp.status === 200) {\n          if (success) {\n            success.call(scope, xmlhttp);\n          }\n        } else if (failure) {\n          failure.call(scope, xmlhttp);\n        }\n      }\n    };\n    xmlhttp.open('GET', url, true);\n    if (opt_requestHeaders) {\n      for (var key in opt_requestHeaders) {\n        if (opt_requestHeaders.hasOwnProperty(key)) {\n          xmlhttp.setRequestHeader(key, opt_requestHeaders[key]);\n        }\n      }\n    }\n    xmlhttp.send();\n    return xmlhttp;\n  },\n  doPOST: function doPOST(url, data, success, failure, scope, contentType, put, opt_requestHeaders) {\n    var xmlhttp = new XMLHttpRequest();\n    xmlhttp.open(put ? 'PUT' : 'POST', url, true);\n    xmlhttp.setRequestHeader('Content-Type', contentType ? contentType : 'text/xml');\n    xmlhttp.onreadystatechange = function () {\n      if (xmlhttp.readyState === 4) {\n        if (xmlhttp.status === 200 || xmlhttp.status === 201) {\n          success.call(scope, xmlhttp);\n        } else {\n          failure.call(scope, xmlhttp);\n        }\n      }\n    };\n    if (opt_requestHeaders) {\n      for (var key in opt_requestHeaders) {\n        if (opt_requestHeaders.hasOwnProperty(key)) {\n          xmlhttp.setRequestHeader(key, opt_requestHeaders[key]);\n        }\n      }\n    }\n    xmlhttp.send(data);\n    return xmlhttp;\n  }\n}; /*\n    * Copyright 2015-present Boundless Spatial Inc., http://boundlessgeo.com\n    * Licensed under the Apache License, Version 2.0 (the \"License\").\n    * You may not use this file except in compliance with the License.\n    * You may obtain a copy of the License at\n    * http://www.apache.org/licenses/LICENSE-2.0\n    * Unless required by applicable law or agreed to in writing, software\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    * See the License for the specific language governing permissions and limitations under the License.\n    */\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/boundless-sdk/util.js\n// module id = 27\n// module chunks = 4 5 6","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright 2015-present Boundless Spatial Inc., http://boundlessgeo.com\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\").\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may not use this file except in compliance with the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * http://www.apache.org/licenses/LICENSE-2.0\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and limitations under the License.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _util = require('../util');\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _openlayers = require('openlayers');\n\nvar _openlayers2 = _interopRequireDefault(_openlayers);\n\nvar _urlParse = require('url-parse');\n\nvar _urlParse2 = _interopRequireDefault(_urlParse);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar format = new _openlayers2.default.format.EsriJSON();\n\nvar ArcGISRestService = function () {\n  function ArcGISRestService() {\n    _classCallCheck(this, ArcGISRestService);\n  }\n\n  _createClass(ArcGISRestService, [{\n    key: 'createLayer',\n    value: function createLayer(layer, url, titleObj, projection) {\n      var units = projection.getUnits();\n      return new _openlayers2.default.layer.Tile({\n        title: titleObj.title,\n        emptyTitle: titleObj.empty,\n        id: layer.Name,\n        maxResolution: layer.MinScale !== 0 ? _util2.default.getResolutionForScale(layer.MinScale, units) : undefined,\n        minResolution: layer.MaxScale !== 0 ? _util2.default.getResolutionForScale(layer.MaxScale, units) : undefined,\n        name: layer.Name,\n        isRemovable: true,\n        wfsInfo: layer.Queryable,\n        popupInfo: layer.Queryable ? '#AllAttributes' : undefined,\n        source: new _openlayers2.default.source.TileArcGISRest({\n          urls: [url],\n          params: {\n            LAYERS: layer.Name\n          }\n        })\n      });\n    }\n  }, {\n    key: 'parseCapabilities',\n    value: function parseCapabilities(jsonData) {\n      var layers = [];\n      // TODO parse layer hierarchy\n      for (var i = 0, ii = jsonData.layers.length; i < ii; ++i) {\n        var layer = {};\n        var esriLayer = jsonData.layers[i];\n        layer.MinScale = esriLayer.minScale;\n        layer.MaxScale = esriLayer.maxScale;\n        layer.Name = String(esriLayer.id);\n        layer.Queryable = jsonData.capabilities && jsonData.capabilities.indexOf('Query') !== -1;\n        layer.Title = esriLayer.name;\n        layers.push(layer);\n      }\n      return {\n        Layer: layers,\n        Title: jsonData.serviceDescription\n      };\n    }\n  }, {\n    key: 'getCapabilitiesUrl',\n    value: function getCapabilitiesUrl(url) {\n      var urlObj = new _urlParse2.default(url);\n      urlObj.set('query', {\n        f: 'json',\n        pretty: 'false',\n        callback: '__cbname__'\n      });\n      return urlObj.toString();\n    }\n  }, {\n    key: 'getCapabilities',\n    value: function getCapabilities(url, onSuccess, onFailure, opt_proxy) {\n      // because it's JSONP we don't need to take into account opt_proxy\n      _util2.default.doJSONP(this.getCapabilitiesUrl(url), function (jsonData) {\n        onSuccess.call(this, this.parseCapabilities(jsonData));\n      }, onFailure, this);\n    }\n  }, {\n    key: 'getLegendUrl',\n    value: function getLegendUrl(url) {\n      var urlObj = new _urlParse2.default(url + '/legend');\n      urlObj.set('query', {\n        f: 'json',\n        pretty: 'false',\n        callback: '__cbname__'\n      });\n      return urlObj.toString();\n    }\n  }, {\n    key: 'getLegend',\n    value: function getLegend(url, onSuccess) {\n      _util2.default.doJSONP(this.getLegendUrl(url), function (jsonData) {\n        onSuccess.call(this, jsonData);\n      }, undefined, this);\n    }\n  }, {\n    key: 'getFeatureInfoUrl',\n    value: function getFeatureInfoUrl(layer, coordinate, map) {\n      var view = map.getView();\n      var urlObj = new _urlParse2.default(layer.getSource().getUrls()[0] + '/identify');\n      urlObj.set('query', {\n        geometryType: 'esriGeometryPoint',\n        geometry: coordinate.join(','),\n        sr: view.getProjection().getCode().split(':')[1],\n        layers: layer.get('name'),\n        tolerance: 2,\n        mapExtent: view.calculateExtent(map.getSize()).join(','),\n        imageDisplay: map.getSize().join(',') + ',90',\n        f: 'json',\n        callback: '__cbname__',\n        pretty: 'false'\n      });\n      return urlObj.toString();\n    }\n  }, {\n    key: 'parseGetFeatureInfo',\n    value: function parseGetFeatureInfo(layer, jsonData) {\n      var response = { layer: layer, features: [] };\n      for (var i = 0, ii = jsonData.results.length; i < ii; ++i) {\n        var feature = format.readFeature(jsonData.results[i]);\n        if (feature) {\n          response.features.push(feature);\n        }\n      }\n      return response;\n    }\n  }, {\n    key: 'getFeatureInfo',\n    value: function getFeatureInfo(layer, coordinate, map, infoFormat, onSuccess, onFailure, opt_proxy) {\n      var url = this.getFeatureInfoUrl(layer, coordinate, map);\n      var me = this;\n      _util2.default.doJSONP(url, function (jsonData) {\n        onSuccess.call(me, me.parseGetFeatureInfo(layer, jsonData));\n      });\n    }\n  }, {\n    key: 'getLoadFeaturesUrl',\n    value: function getLoadFeaturesUrl(layer, startIndex, pageSize, sortingInfo, srsName) {\n      var urlObj = new _urlParse2.default(layer.getSource().getUrls()[0] + '/' + layer.get('name') + '/query');\n      var params = {\n        where: 'OBJECTID >= ' + startIndex + ' AND OBJECTID < ' + (startIndex + pageSize),\n        f: 'json',\n        callback: '__cbname__',\n        pretty: 'false',\n        outSR: srsName.split(':')[1]\n      };\n      if (sortingInfo.length === 1) {\n        params.orderByFields = sortingInfo[0].id + ' ' + (sortingInfo[0].asc ? 'ASC' : 'DESC');\n      }\n      urlObj.set('query', params);\n      return urlObj.toString();\n    }\n  }, {\n    key: 'loadFeatures',\n    value: function loadFeatures(layer, startIndex, pageSize, sortingInfo, srsName, success, failure) {\n      _util2.default.doJSONP(this.getLoadFeaturesUrl(layer, startIndex, pageSize, sortingInfo, srsName), function (jsonData) {\n        if (jsonData.error) {\n          failure.call(this, { status: jsonData.error.code, statusText: jsonData.error.message }, jsonData.error.details.join(' '));\n        } else {\n          success.call(this, format.readFeatures(jsonData));\n        }\n      }, failure, this);\n    }\n  }, {\n    key: 'getNumberOfFeaturesUrl',\n    value: function getNumberOfFeaturesUrl(layer) {\n      var urlObj = new _urlParse2.default(layer.getSource().getUrls()[0] + '/' + layer.get('name') + '/query');\n      var params = {\n        where: '1=1',\n        f: 'json',\n        callback: '__cbname__',\n        pretty: 'false',\n        returnCountOnly: true\n      };\n      urlObj.set('query', params);\n      return urlObj.toString();\n    }\n  }, {\n    key: 'getNumberOfFeatures',\n    value: function getNumberOfFeatures(layer, callback) {\n      if (layer.get('numberOfFeatures') === undefined) {\n        _util2.default.doJSONP(this.getNumberOfFeaturesUrl(layer), function (jsonData) {\n          callback.call(this, jsonData.count);\n        }, undefined, this);\n      }\n    }\n  }]);\n\n  return ArcGISRestService;\n}();\n\nexports.default = new ArcGISRestService();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/boundless-sdk/services/ArcGISRestService.js\n// module id = 286\n// module chunks = 6","'use strict';\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * Decode a URI encoded string.\n *\n * @param {String} input The URI encoded string.\n * @returns {String} The decoded string.\n * @api private\n */\nfunction decode(input) {\n  return decodeURIComponent(input.replace(/\\+/g, ' '));\n}\n\n/**\n * Simple query string parser.\n *\n * @param {String} query The query string that needs to be parsed.\n * @returns {Object}\n * @api public\n */\nfunction querystring(query) {\n  var parser = /([^=?&]+)=?([^&]*)/g\n    , result = {}\n    , part;\n\n  //\n  // Little nifty parsing hack, leverage the fact that RegExp.exec increments\n  // the lastIndex property so we can continue executing this loop until we've\n  // parsed all results.\n  //\n  for (;\n    part = parser.exec(query);\n    result[decode(part[1])] = decode(part[2])\n  );\n\n  return result;\n}\n\n/**\n * Transform a query string to an object.\n *\n * @param {Object} obj Object that should be transformed.\n * @param {String} prefix Optional prefix.\n * @returns {String}\n * @api public\n */\nfunction querystringify(obj, prefix) {\n  prefix = prefix || '';\n\n  var pairs = [];\n\n  //\n  // Optionally prefix with a '?' if needed\n  //\n  if ('string' !== typeof prefix) prefix = '?';\n\n  for (var key in obj) {\n    if (has.call(obj, key)) {\n      pairs.push(encodeURIComponent(key) +'='+ encodeURIComponent(obj[key]));\n    }\n  }\n\n  return pairs.length ? prefix + pairs.join('&') : '';\n}\n\n//\n// Expose the module.\n//\nexports.stringify = querystringify;\nexports.parse = querystring;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/querystringify/index.js\n// module id = 45\n// module chunks = 4 5 6","'use strict';\n\n/**\n * Check if we're required to add a port number.\n *\n * @see https://url.spec.whatwg.org/#default-port\n * @param {Number|String} port Port number we need to check\n * @param {String} protocol Protocol we need to check against.\n * @returns {Boolean} Is it a default port for the given protocol\n * @api private\n */\nmodule.exports = function required(port, protocol) {\n  protocol = protocol.split(':')[0];\n  port = +port;\n\n  if (!port) return false;\n\n  switch (protocol) {\n    case 'http':\n    case 'ws':\n    return port !== 80;\n\n    case 'https':\n    case 'wss':\n    return port !== 443;\n\n    case 'ftp':\n    return port !== 21;\n\n    case 'gopher':\n    return port !== 70;\n\n    case 'file':\n    return false;\n  }\n\n  return port !== 0;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/requires-port/index.js\n// module id = 50\n// module chunks = 4 5 6","'use strict';\n\nvar required = require('requires-port')\n  , qs = require('querystringify')\n  , protocolre = /^([a-z][a-z0-9.+-]*:)?(\\/\\/)?([\\S\\s]*)/i\n  , slashes = /^[A-Za-z][A-Za-z0-9+-.]*:\\/\\//;\n\n/**\n * These are the parse rules for the URL parser, it informs the parser\n * about:\n *\n * 0. The char it Needs to parse, if it's a string it should be done using\n *    indexOf, RegExp using exec and NaN means set as current value.\n * 1. The property we should set when parsing this value.\n * 2. Indication if it's backwards or forward parsing, when set as number it's\n *    the value of extra chars that should be split off.\n * 3. Inherit from location if non existing in the parser.\n * 4. `toLowerCase` the resulting value.\n */\nvar rules = [\n  ['#', 'hash'],                        // Extract from the back.\n  ['?', 'query'],                       // Extract from the back.\n  ['/', 'pathname'],                    // Extract from the back.\n  ['@', 'auth', 1],                     // Extract from the front.\n  [NaN, 'host', undefined, 1, 1],       // Set left over value.\n  [/:(\\d+)$/, 'port', undefined, 1],    // RegExp the back.\n  [NaN, 'hostname', undefined, 1, 1]    // Set left over.\n];\n\n/**\n * These properties should not be copied or inherited from. This is only needed\n * for all non blob URL's as a blob URL does not include a hash, only the\n * origin.\n *\n * @type {Object}\n * @private\n */\nvar ignore = { hash: 1, query: 1 };\n\n/**\n * The location object differs when your code is loaded through a normal page,\n * Worker or through a worker using a blob. And with the blobble begins the\n * trouble as the location object will contain the URL of the blob, not the\n * location of the page where our code is loaded in. The actual origin is\n * encoded in the `pathname` so we can thankfully generate a good \"default\"\n * location from it so we can generate proper relative URL's again.\n *\n * @param {Object|String} loc Optional default location object.\n * @returns {Object} lolcation object.\n * @api public\n */\nfunction lolcation(loc) {\n  loc = loc || global.location || {};\n\n  var finaldestination = {}\n    , type = typeof loc\n    , key;\n\n  if ('blob:' === loc.protocol) {\n    finaldestination = new URL(unescape(loc.pathname), {});\n  } else if ('string' === type) {\n    finaldestination = new URL(loc, {});\n    for (key in ignore) delete finaldestination[key];\n  } else if ('object' === type) {\n    for (key in loc) {\n      if (key in ignore) continue;\n      finaldestination[key] = loc[key];\n    }\n\n    if (finaldestination.slashes === undefined) {\n      finaldestination.slashes = slashes.test(loc.href);\n    }\n  }\n\n  return finaldestination;\n}\n\n/**\n * @typedef ProtocolExtract\n * @type Object\n * @property {String} protocol Protocol matched in the URL, in lowercase.\n * @property {Boolean} slashes `true` if protocol is followed by \"//\", else `false`.\n * @property {String} rest Rest of the URL that is not part of the protocol.\n */\n\n/**\n * Extract protocol information from a URL with/without double slash (\"//\").\n *\n * @param {String} address URL we want to extract from.\n * @return {ProtocolExtract} Extracted information.\n * @api private\n */\nfunction extractProtocol(address) {\n  var match = protocolre.exec(address);\n\n  return {\n    protocol: match[1] ? match[1].toLowerCase() : '',\n    slashes: !!match[2],\n    rest: match[3]\n  };\n}\n\n/**\n * Resolve a relative URL pathname against a base URL pathname.\n *\n * @param {String} relative Pathname of the relative URL.\n * @param {String} base Pathname of the base URL.\n * @return {String} Resolved pathname.\n * @api private\n */\nfunction resolve(relative, base) {\n  var path = (base || '/').split('/').slice(0, -1).concat(relative.split('/'))\n    , i = path.length\n    , last = path[i - 1]\n    , unshift = false\n    , up = 0;\n\n  while (i--) {\n    if (path[i] === '.') {\n      path.splice(i, 1);\n    } else if (path[i] === '..') {\n      path.splice(i, 1);\n      up++;\n    } else if (up) {\n      if (i === 0) unshift = true;\n      path.splice(i, 1);\n      up--;\n    }\n  }\n\n  if (unshift) path.unshift('');\n  if (last === '.' || last === '..') path.push('');\n\n  return path.join('/');\n}\n\n/**\n * The actual URL instance. Instead of returning an object we've opted-in to\n * create an actual constructor as it's much more memory efficient and\n * faster and it pleases my OCD.\n *\n * @constructor\n * @param {String} address URL we want to parse.\n * @param {Object|String} location Location defaults for relative paths.\n * @param {Boolean|Function} parser Parser for the query string.\n * @api public\n */\nfunction URL(address, location, parser) {\n  if (!(this instanceof URL)) {\n    return new URL(address, location, parser);\n  }\n\n  var relative, extracted, parse, instruction, index, key\n    , instructions = rules.slice()\n    , type = typeof location\n    , url = this\n    , i = 0;\n\n  //\n  // The following if statements allows this module two have compatibility with\n  // 2 different API:\n  //\n  // 1. Node.js's `url.parse` api which accepts a URL, boolean as arguments\n  //    where the boolean indicates that the query string should also be parsed.\n  //\n  // 2. The `URL` interface of the browser which accepts a URL, object as\n  //    arguments. The supplied object will be used as default values / fall-back\n  //    for relative paths.\n  //\n  if ('object' !== type && 'string' !== type) {\n    parser = location;\n    location = null;\n  }\n\n  if (parser && 'function' !== typeof parser) parser = qs.parse;\n\n  location = lolcation(location);\n\n  //\n  // Extract protocol information before running the instructions.\n  //\n  extracted = extractProtocol(address || '');\n  relative = !extracted.protocol && !extracted.slashes;\n  url.slashes = extracted.slashes || relative && location.slashes;\n  url.protocol = extracted.protocol || location.protocol || '';\n  address = extracted.rest;\n\n  //\n  // When the authority component is absent the URL starts with a path\n  // component.\n  //\n  if (!extracted.slashes) instructions[2] = [/(.*)/, 'pathname'];\n\n  for (; i < instructions.length; i++) {\n    instruction = instructions[i];\n    parse = instruction[0];\n    key = instruction[1];\n\n    if (parse !== parse) {\n      url[key] = address;\n    } else if ('string' === typeof parse) {\n      if (~(index = address.indexOf(parse))) {\n        if ('number' === typeof instruction[2]) {\n          url[key] = address.slice(0, index);\n          address = address.slice(index + instruction[2]);\n        } else {\n          url[key] = address.slice(index);\n          address = address.slice(0, index);\n        }\n      }\n    } else if ((index = parse.exec(address))) {\n      url[key] = index[1];\n      address = address.slice(0, index.index);\n    }\n\n    url[key] = url[key] || (\n      relative && instruction[3] ? location[key] || '' : ''\n    );\n\n    //\n    // Hostname, host and protocol should be lowercased so they can be used to\n    // create a proper `origin`.\n    //\n    if (instruction[4]) url[key] = url[key].toLowerCase();\n  }\n\n  //\n  // Also parse the supplied query string in to an object. If we're supplied\n  // with a custom parser as function use that instead of the default build-in\n  // parser.\n  //\n  if (parser) url.query = parser(url.query);\n\n  //\n  // If the URL is relative, resolve the pathname against the base URL.\n  //\n  if (\n      relative\n    && location.slashes\n    && url.pathname.charAt(0) !== '/'\n    && (url.pathname !== '' || location.pathname !== '')\n  ) {\n    url.pathname = resolve(url.pathname, location.pathname);\n  }\n\n  //\n  // We should not add port numbers if they are already the default port number\n  // for a given protocol. As the host also contains the port number we're going\n  // override it with the hostname which contains no port number.\n  //\n  if (!required(url.port, url.protocol)) {\n    url.host = url.hostname;\n    url.port = '';\n  }\n\n  //\n  // Parse down the `auth` for the username and password.\n  //\n  url.username = url.password = '';\n  if (url.auth) {\n    instruction = url.auth.split(':');\n    url.username = instruction[0] || '';\n    url.password = instruction[1] || '';\n  }\n\n  url.origin = url.protocol && url.host && url.protocol !== 'file:'\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  //\n  // The href is just the compiled result.\n  //\n  url.href = url.toString();\n}\n\n/**\n * This is convenience method for changing properties in the URL instance to\n * insure that they all propagate correctly.\n *\n * @param {String} part          Property we need to adjust.\n * @param {Mixed} value          The newly assigned value.\n * @param {Boolean|Function} fn  When setting the query, it will be the function\n *                               used to parse the query.\n *                               When setting the protocol, double slash will be\n *                               removed from the final url if it is true.\n * @returns {URL}\n * @api public\n */\nfunction set(part, value, fn) {\n  var url = this;\n\n  switch (part) {\n    case 'query':\n      if ('string' === typeof value && value.length) {\n        value = (fn || qs.parse)(value);\n      }\n\n      url[part] = value;\n      break;\n\n    case 'port':\n      url[part] = value;\n\n      if (!required(value, url.protocol)) {\n        url.host = url.hostname;\n        url[part] = '';\n      } else if (value) {\n        url.host = url.hostname +':'+ value;\n      }\n\n      break;\n\n    case 'hostname':\n      url[part] = value;\n\n      if (url.port) value += ':'+ url.port;\n      url.host = value;\n      break;\n\n    case 'host':\n      url[part] = value;\n\n      if (/:\\d+$/.test(value)) {\n        value = value.split(':');\n        url.port = value.pop();\n        url.hostname = value.join(':');\n      } else {\n        url.hostname = value;\n        url.port = '';\n      }\n\n      break;\n\n    case 'protocol':\n      url.protocol = value.toLowerCase();\n      url.slashes = !fn;\n      break;\n\n    case 'pathname':\n      url.pathname = value.length && value.charAt(0) !== '/' ? '/' + value : value;\n\n      break;\n\n    default:\n      url[part] = value;\n  }\n\n  for (var i = 0; i < rules.length; i++) {\n    var ins = rules[i];\n\n    if (ins[4]) url[ins[1]] = url[ins[1]].toLowerCase();\n  }\n\n  url.origin = url.protocol && url.host && url.protocol !== 'file:'\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  url.href = url.toString();\n\n  return url;\n}\n\n/**\n * Transform the properties back in to a valid and full URL string.\n *\n * @param {Function} stringify Optional query stringify function.\n * @returns {String}\n * @api public\n */\nfunction toString(stringify) {\n  if (!stringify || 'function' !== typeof stringify) stringify = qs.stringify;\n\n  var query\n    , url = this\n    , protocol = url.protocol;\n\n  if (protocol && protocol.charAt(protocol.length - 1) !== ':') protocol += ':';\n\n  var result = protocol + (url.slashes ? '//' : '');\n\n  if (url.username) {\n    result += url.username;\n    if (url.password) result += ':'+ url.password;\n    result += '@';\n  }\n\n  result += url.host + url.pathname;\n\n  query = 'object' === typeof url.query ? stringify(url.query) : url.query;\n  if (query) result += '?' !== query.charAt(0) ? '?'+ query : query;\n\n  if (url.hash) result += url.hash;\n\n  return result;\n}\n\nURL.prototype = { set: set, toString: toString };\n\n//\n// Expose the URL parser and some additional properties that might be useful for\n// others or testing.\n//\nURL.extractProtocol = extractProtocol;\nURL.location = lolcation;\nURL.qs = qs;\n\nmodule.exports = URL;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/url-parse/index.js\n// module id = 51\n// module chunks = 4 5 6","import React, {Component} from 'react';\r\n\r\nimport ArcGISRestService from 'boundless-sdk/services/ArcGISRestService';\r\nimport Events from './events/Events.jsx';\r\nimport ol from 'openlayers';\r\nimport FieldSet from './components/FieldSet.jsx';\r\n\r\nclass ArcGISLegend extends Component {\r\n    render() {\r\n        if (this.state && this.state.legendInfo) {\r\n            var layers = this.state.legendInfo.layers;\r\n            const style = {width: 'auto', height: 'auto'};\r\n            return <div>\r\n                {\r\n                    layers.map(l => {\r\n                        return l.legend.map(legend => <div>\r\n                            <img style={style} src={'data:' + legend.contentType + ';base64,' + legend.imageData}/>\r\n                            <span>{legend.label}</span>\r\n                        </div>)\r\n                    })\r\n                }\r\n            </div>\r\n        }\r\n        return null\r\n    }\r\n\r\n    componentDidMount() {\r\n        var layer = this.props.layer;\r\n        var source = layer.getSource();\r\n        var url = source.getUrls()[0];\r\n        ArcGISRestService.getLegend(url, (legendInfo) => {\r\n            this.setState({legendInfo});\r\n        });\r\n    }\r\n}\r\n\r\nclass Legend extends Component {\r\n    render() {\r\n        const {map} = this.props;\r\n        const legends = this.getLegends(map.getLayers().getArray())\r\n        return <div>\r\n            {legends}\r\n        </div>\r\n    }\r\n\r\n    getLegends(layers) {\r\n        var legends = [];\r\n        layers.forEach((layer) => {\r\n            if (layer instanceof ol.layer.Group) {\r\n                legends = legends.concat(this.getLegends(layer.getLayers()))\r\n            } else if (layer.getVisible() && this.hasLegend(\r\n                layer)) {\r\n                if (this.isWMS(layer)) {\r\n                    var s = layer.getSource(),\r\n                        p = s.getParams();\r\n                    var url = s.getUrls()[0];\r\n                    url += (url.indexOf(\"?\") == -1) ? \"?\" :\r\n                        \"&\";\r\n                    url += \"layer=\" + p.LAYERS;\r\n                    url +=\r\n                        \"&request=GetLegendGraphic&format=image%2Fpng&transparent=true&legend_options=fontAntiAliasing:true;fontSize:14;&width=30&height=30\"\r\n                    url += \"&style=\" + (p.STYLES || '')\r\n                    legends.push(\r\n                        <div>\r\n                            <h4>{layer.get('title')}</h4>\r\n                            <img src={url}/>\r\n                        </div>\r\n                    );\r\n                } else if (layer.getSource() instanceof ol.source\r\n                    .TileArcGISRest) {\r\n                    legends.push(\r\n                        <div><h4>{layer.get('title')}</h4> <ArcGISLegend layer={layer}/></div>\r\n                    );\r\n                }\r\n            }\r\n        });\r\n        return legends;\r\n    }\r\n\r\n    hasLegend(layer) {\r\n        return (layer instanceof ol.layer.Tile && layer.getSource() instanceof ol\r\n            .source.TileWMS) || (layer instanceof ol.layer.Image &&\r\n            layer.getSource() instanceof ol.source.ImageWMS) || (\r\n            layer instanceof ol.layer.Tile && layer.getSource() instanceof ol\r\n                .source.TileArcGISRest);\r\n    }\r\n\r\n    isWMS(layer) {\r\n        return layer.getSource() instanceof ol.source.TileWMS || layer.getSource() instanceof ol\r\n            .source.ImageWMS;\r\n    }\r\n}\r\n\r\nclass LegendWidget extends BaseWidget {\r\n    static displayName = \"Legend\";\r\n\r\n    render() {\r\n        const style = {\r\n            padding: \"10px 20px\"\r\n        }\r\n        return <div style={style}>\r\n            {\r\n                this.state && this.state.ready ? <Legend map={this.state.map}/> :\r\n                    <span>The map for this Legend widget must be configured.  Click <i\r\n                        className=\"glyphicon glyphicon-cog\" style={{color:'#337ab7'}}></i> icon and select a map within this dashboard.</span>\r\n            }\r\n        </div>;\r\n    }\r\n\r\n    setConfig(config) {\r\n        super.setConfig(config);\r\n        this.attachToMapWidget(config.mapWidget)\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.state.config.mapWidget)\r\n            this.attachToMapWidget(this.state.config.mapWidget);\r\n        super.componentDidMount()\r\n    }\r\n\r\n    attachToMapWidget(mapWidgetId) {\r\n        var mapWidget = this.context.configManager.getWidget(mapWidgetId);\r\n        if (mapWidget && mapWidget.ready) {\r\n            this.setState({ready: true, map: mapWidget.map})\r\n        } else {\r\n            Events.on('mapReady' + '_' + mapWidgetId, (map) => {\r\n                this.setState({ready: true, map})\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nclass ConfigForm extends FieldSet {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state.maps = [];\r\n    }\r\n\r\n    getSchema(props) {\r\n        return {\r\n            mapWidget: {\r\n                type: 'select',\r\n                lable: 'Map',\r\n                options: {},\r\n                props: {}\r\n            }\r\n        };\r\n    }\r\n\r\n    getInitialData(props) {\r\n        return props.widget.getConfig();\r\n    }\r\n\r\n    getSelectOptions(name, config, value) {\r\n        var mapWidgets = this.props.widget.context.configManager.getMapWidgets();\r\n        return Object.keys(mapWidgets).filter(widgetId => dash.props.widgets[widgetId].type.name == \"MapWidget\").map(widgetId =>\r\n            <option value={widgetId}>{mapWidgets[widgetId].title} - {widgetId}</option>);\r\n    }\r\n\r\n    // componentWillMount() {\r\n    //     getMapsData().then(res => this.setState({maps: res.objects}));\r\n    // }\r\n}\r\n\r\nLegendWidget.ConfigForm = ConfigForm;\r\nDashboard.registerWidget(LegendWidget);\r\nexport default LegendWidget;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/legend-widget.jsx"],"sourceRoot":""}