webpackJsonp([6],{14:function(e,t,n){"use strict";t.__esModule=!0;var r=n(19);t.default=new r.EventEmitter},19:function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,a,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],i(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(s(n))for(a=Array.prototype.slice.call(arguments,1),l=n.slice(),o=l.length,u=0;u<o;u++)l[u].apply(this,a);return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(o=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,i,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(a=i;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},25:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),s=r(o);t.default={getProxiedUrl:function(e,t){return t?t+encodeURIComponent(e):e},getResolutionForScale:function(e,t){var n=25.4/.28,r=s.default.proj.METERS_PER_UNIT[t];return parseFloat(e)/(39.37*r*n)},getTimeInfo:function(e){if(e.Dimension)for(var t=0,n=e.Dimension.length;t<n;++t){var r=e.Dimension[t];if("time"===r.name)return r.values}},rgbToHex:function(e){return e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},hexToRgb:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},transformColor:function(e){var t=e.rgb?e.rgb:e;return[t.r,t.g,t.b,t.a]},doJSONP:function(e,t,n,r){function o(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}var s="fn"+Date.now()+o(1,1e4),i=document.createElement("script");i.onerror=function(){n&&n.call(r)},i.src=e.replace("__cbname__",s),window[s]=function(e){t.call(r,e),delete window[s]},document.head.appendChild(i)},doGET:function(e,t,n,r,o){var s=new XMLHttpRequest;if(s.onreadystatechange=function(){4===s.readyState&&(200===s.status?t&&t.call(r,s):n&&n.call(r,s))},s.open("GET",e,!0),o)for(var i in o)o.hasOwnProperty(i)&&s.setRequestHeader(i,o[i]);return s.send(),s},doPOST:function(e,t,n,r,o,s,i,a){var u=new XMLHttpRequest;if(u.open(i?"PUT":"POST",e,!0),u.setRequestHeader("Content-Type",s||"text/xml"),u.onreadystatechange=function(){4===u.readyState&&(200===u.status||201===u.status?n.call(o,u):r.call(o,u))},a)for(var l in a)a.hasOwnProperty(l)&&u.setRequestHeader(l,a[l]);return u.send(t),u}}},275:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(25),a=r(i),u=n(10),l=r(u),c=n(49),f=r(c),h=new l.default.format.EsriJSON,p=function(){function e(){o(this,e)}return s(e,[{key:"createLayer",value:function(e,t,n,r){var o=r.getUnits();return new l.default.layer.Tile({title:n.title,emptyTitle:n.empty,id:e.Name,maxResolution:0!==e.MinScale?a.default.getResolutionForScale(e.MinScale,o):void 0,minResolution:0!==e.MaxScale?a.default.getResolutionForScale(e.MaxScale,o):void 0,name:e.Name,isRemovable:!0,wfsInfo:e.Queryable,popupInfo:e.Queryable?"#AllAttributes":void 0,source:new l.default.source.TileArcGISRest({urls:[t],params:{LAYERS:e.Name}})})}},{key:"parseCapabilities",value:function(e){for(var t=[],n=0,r=e.layers.length;n<r;++n){var o={},s=e.layers[n];o.MinScale=s.minScale,o.MaxScale=s.maxScale,o.Name=String(s.id),o.Queryable=e.capabilities&&-1!==e.capabilities.indexOf("Query"),o.Title=s.name,t.push(o)}return{Layer:t,Title:e.serviceDescription}}},{key:"getCapabilitiesUrl",value:function(e){var t=new f.default(e);return t.set("query",{f:"json",pretty:"false",callback:"__cbname__"}),t.toString()}},{key:"getCapabilities",value:function(e,t,n,r){a.default.doJSONP(this.getCapabilitiesUrl(e),function(e){t.call(this,this.parseCapabilities(e))},n,this)}},{key:"getLegendUrl",value:function(e){var t=new f.default(e+"/legend");return t.set("query",{f:"json",pretty:"false",callback:"__cbname__"}),t.toString()}},{key:"getLegend",value:function(e,t){a.default.doJSONP(this.getLegendUrl(e),function(e){t.call(this,e)},void 0,this)}},{key:"getFeatureInfoUrl",value:function(e,t,n){var r=n.getView(),o=new f.default(e.getSource().getUrls()[0]+"/identify");return o.set("query",{geometryType:"esriGeometryPoint",geometry:t.join(","),sr:r.getProjection().getCode().split(":")[1],layers:e.get("name"),tolerance:2,mapExtent:r.calculateExtent(n.getSize()).join(","),imageDisplay:n.getSize().join(",")+",90",f:"json",callback:"__cbname__",pretty:"false"}),o.toString()}},{key:"parseGetFeatureInfo",value:function(e,t){for(var n={layer:e,features:[]},r=0,o=t.results.length;r<o;++r){var s=h.readFeature(t.results[r]);s&&n.features.push(s)}return n}},{key:"getFeatureInfo",value:function(e,t,n,r,o,s,i){var u=this.getFeatureInfoUrl(e,t,n),l=this;a.default.doJSONP(u,function(t){o.call(l,l.parseGetFeatureInfo(e,t))})}},{key:"getLoadFeaturesUrl",value:function(e,t,n,r,o){var s=new f.default(e.getSource().getUrls()[0]+"/"+e.get("name")+"/query"),i={where:"OBJECTID >= "+t+" AND OBJECTID < "+(t+n),f:"json",callback:"__cbname__",pretty:"false",outSR:o.split(":")[1]};return 1===r.length&&(i.orderByFields=r[0].id+" "+(r[0].asc?"ASC":"DESC")),s.set("query",i),s.toString()}},{key:"loadFeatures",value:function(e,t,n,r,o,s,i){a.default.doJSONP(this.getLoadFeaturesUrl(e,t,n,r,o),function(e){e.error?i.call(this,{status:e.error.code,statusText:e.error.message},e.error.details.join(" ")):s.call(this,h.readFeatures(e))},i,this)}},{key:"getNumberOfFeaturesUrl",value:function(e){var t=new f.default(e.getSource().getUrls()[0]+"/"+e.get("name")+"/query"),n={where:"1=1",f:"json",callback:"__cbname__",pretty:"false",returnCountOnly:!0};return t.set("query",n),t.toString()}},{key:"getNumberOfFeatures",value:function(e,t){void 0===e.get("numberOfFeatures")&&a.default.doJSONP(this.getNumberOfFeaturesUrl(e),function(e){t.call(this,e.count)},void 0,this)}}]),e}();t.default=new p},42:function(e,t,n){"use strict";function r(e){return decodeURIComponent(e.replace(/\+/g," "))}function o(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,o={};t=n.exec(e);o[r(t[1])]=r(t[2]));return o}function s(e,t){t=t||"";var n=[];"string"!=typeof t&&(t="?");for(var r in e)i.call(e,r)&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return n.length?t+n.join("&"):""}var i=Object.prototype.hasOwnProperty;t.stringify=s,t.parse=o},48:function(e,t,n){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},49:function(e,t,n){"use strict";(function(t){function r(e){e=e||t.location||{};var n,r={},o=typeof e;if("blob:"===e.protocol)r=new i(unescape(e.pathname),{});else if("string"===o){r=new i(e,{});for(n in d)delete r[n]}else if("object"===o){for(n in e)n in d||(r[n]=e[n]);void 0===r.slashes&&(r.slashes=h.test(e.href))}return r}function o(e){var t=f.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function s(e,t){for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,o=n[r-1],s=!1,i=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),i++):i&&(0===r&&(s=!0),n.splice(r,1),i--);return s&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}function i(e,t,n){if(!(this instanceof i))return new i(e,t,n);var a,u,f,h,d,v,g=p.slice(),y=typeof t,m=this,_=0;for("object"!==y&&"string"!==y&&(n=t,t=null),n&&"function"!=typeof n&&(n=c.parse),t=r(t),u=o(e||""),a=!u.protocol&&!u.slashes,m.slashes=u.slashes||a&&t.slashes,m.protocol=u.protocol||t.protocol||"",e=u.rest,u.slashes||(g[2]=[/(.*)/,"pathname"]);_<g.length;_++)h=g[_],f=h[0],v=h[1],f!==f?m[v]=e:"string"==typeof f?~(d=e.indexOf(f))&&("number"==typeof h[2]?(m[v]=e.slice(0,d),e=e.slice(d+h[2])):(m[v]=e.slice(d),e=e.slice(0,d))):(d=f.exec(e))&&(m[v]=d[1],e=e.slice(0,d.index)),m[v]=m[v]||(a&&h[3]?t[v]||"":""),h[4]&&(m[v]=m[v].toLowerCase());n&&(m.query=n(m.query)),a&&t.slashes&&"/"!==m.pathname.charAt(0)&&(""!==m.pathname||""!==t.pathname)&&(m.pathname=s(m.pathname,t.pathname)),l(m.port,m.protocol)||(m.host=m.hostname,m.port=""),m.username=m.password="",m.auth&&(h=m.auth.split(":"),m.username=h[0]||"",m.password=h[1]||""),m.origin=m.protocol&&m.host&&"file:"!==m.protocol?m.protocol+"//"+m.host:"null",m.href=m.toString()}function a(e,t,n){var r=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||c.parse)(t)),r[e]=t;break;case"port":r[e]=t,l(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,/:\d+$/.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";r[e]=t.charAt(0)!==o?o+t:t}else r[e]=t;break;default:r[e]=t}for(var s=0;s<p.length;s++){var i=p[s];i[4]&&(r[i[1]]=r[i[1]].toLowerCase())}return r.origin=r.protocol&&r.host&&"file:"!==r.protocol?r.protocol+"//"+r.host:"null",r.href=r.toString(),r}function u(e){e&&"function"==typeof e||(e=c.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var o=r+(n.slashes?"//":"");return n.username&&(o+=n.username,n.password&&(o+=":"+n.password),o+="@"),o+=n.host+n.pathname,t="object"==typeof n.query?e(n.query):n.query,t&&(o+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(o+=n.hash),o}var l=n(48),c=n(42),f=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,h=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,p=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],d={hash:1,query:1};i.prototype={set:a,toString:u},i.extractProtocol=o,i.location=r,i.qs=c,e.exports=i}).call(t,n(13))},588:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){var e="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;return function(t,n,r,o){var s=t&&t.defaultProps,i=arguments.length-3;if(n||0===i||(n={}),n&&s)for(var a in s)void 0===n[a]&&(n[a]=s[a]);else n||(n=s||{});if(1===i)n.children=o;else if(i>1){for(var u=Array(i),l=0;l<i;l++)u[l]=arguments[l+3];n.children=u}return{$$typeof:e,type:t,key:void 0===r?null:""+r,ref:null,props:n,_owner:null}}}(),u=n(2),l=r(u),c=n(275),f=r(c),h=n(14),p=r(h),d=n(10),v=r(d),g=function(e){function t(){return o(this,t),s(this,e.apply(this,arguments))}return i(t,e),t.prototype.render=function(){if(this.state&&this.state.legendInfo){var e=this.state.legendInfo.layers,t={width:"auto",height:"auto"};return a("div",{},void 0,e.map(function(e){return e.legend.map(function(e){return a("div",{},void 0,a("img",{style:t,src:"data:"+e.contentType+";base64,"+e.imageData}),a("span",{},void 0,e.label))})}))}return null},t.prototype.componentDidMount=function(){var e=this,t=this.props.layer,n=t.getSource(),r=n.getUrls()[0];f.default.getLegend(r,function(t){e.setState({legendInfo:t})})},t}(u.Component),y=function(e){function t(){return o(this,t),s(this,e.apply(this,arguments))}return i(t,e),t.prototype.render=function(){var e=this.props.map,t=this.getLegends(e.getLayers().getArray());return a("div",{},void 0,t)},t.prototype.getLegends=function(e){var t=this,n=[];return e.forEach(function(e){if(e instanceof v.default.layer.Group)n=n.concat(t.getLegends(e.getLayers()));else if(e.getVisible()&&t.hasLegend(e))if(t.isWMS(e)){var r=e.getSource(),o=r.getParams(),s=r.getUrls()[0];s+=-1==s.indexOf("?")?"?":"&",s+="layer="+o.LAYERS,s+="&request=GetLegendGraphic&format=image%2Fpng&transparent=true&legend_options=fontAntiAliasing:true;fontSize:14;&width=30&height=30",s+="&style="+(o.STYLES||""),n.push(a("div",{},void 0,a("h4",{},void 0,e.get("title")),a("img",{src:s})))}else e.getSource()instanceof v.default.source.TileArcGISRest&&n.push(a("div",{},void 0," ",a("h4",{},void 0,e.get("title"))," ",a(g,{layer:e})))}),n},t.prototype.hasLegend=function(e){return e instanceof v.default.layer.Tile&&e.getSource()instanceof v.default.source.TileWMS||e instanceof v.default.layer.Image&&e.getSource()instanceof v.default.source.ImageWMS||e instanceof v.default.layer.Tile&&e.getSource()instanceof v.default.source.TileArcGISRest},t.prototype.isWMS=function(e){return e.getSource()instanceof v.default.source.TileWMS||e.getSource()instanceof v.default.source.ImageWMS},t}(u.Component),m=function(e){function t(){return o(this,t),s(this,e.apply(this,arguments))}return i(t,e),t.prototype.render=function(){return a("div",{style:{padding:"10px 20px"}},void 0,this.state&&this.state.ready?a(y,{map:this.state.map}):a("span",{},void 0,"You have to add a map to this dashboard to show the legend."))},t.prototype.componentDidMount=function(){var e=this,t=this.context.configManager.getMapWidget();t.ready?this.setState({ready:!0,map:t.map}):p.default.on("mapReady",function(t){e.setState({ready:!0,map:t})})},t}(BaseWidget);m.displayName="Legend";var _=function(e){function t(){return o(this,t),s(this,e.apply(this,arguments))}return i(t,e),t.prototype.render=function(){return null},t.prototype.getData=function(){return{}},t}(l.default.Component);m.ConfigForm=_,Dashboard.registerWidget(m),t.default=m}},[588]);